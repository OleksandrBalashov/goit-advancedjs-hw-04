{"version":3,"file":"commonHelpers.js","sources":["../src/notification.js","../src/services/index.js","../src/templates/card.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport const notifyError = () => {\n  iziToast.show({\n    title: 'Sorry!',\n    message:\n      'There are no images matching your search query. Please try again.',\n    color: 'red',\n    position: 'topRight',\n    maxWidth: 400,\n  });\n};\n\nexport const notifySuccess = value => {\n  iziToast.show({\n    title: 'Hoorey!',\n    message: `We're found ${value} images`,\n    color: 'green',\n    position: 'topRight',\n  });\n};\n\nexport const notifyIsTotal = value => {\n  iziToast.show({\n    title: 'Hey!',\n    message: `We're sorry, but you've reached the end of search results.`,\n    color: 'orange',\n    position: 'topRight',\n  });\n};\n","import axios from 'axios';\nimport { notifyError, notifySuccess } from '../notification';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst API_KEY = '19816759-3cdd4fc89a2e26e9cfb0ce197';\n\nexport const fetchImages = async (value, page = 1, isSubmit) => {\n  const params = new URLSearchParams({\n    q: value,\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n    page,\n  });\n\n  try {\n    const { data } = await axios.get(`?${params}`);\n\n    if (!data.hits.length) throw new Error();\n\n    isSubmit && notifySuccess(data.totalHits);\n\n    return data;\n  } catch (error) {\n    notifyError();\n  }\n};\n","export const createCardTemplate = images =>\n  images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        type,\n      }) => `\n      <li class=\"item\">\n        <a href=\"${largeImageURL}\" src=\"${webformatURL}\" class=\"link\">\n          <img src=\"${webformatURL}\" alt=\"${type}\" class=\"image\" />\n          <div class=\"info\">\n            <p class=\"info-item\">\n              <b>Likes <span>${likes}</span></b>\n            </p>\n            <p class=\"info-item\">\n              <b>Views <span>${views}</span></b>\n            </p>\n            <p class=\"info-item\">\n              <b>Comments <span>${comments}</span></b>\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads <span>${downloads}</span></b>\n            </p>\n          </div>\n        </a>\n      </li>\n    `\n    )\n    .join('');\n","import SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './services';\nimport { createCardTemplate } from './templates/card';\n\nimport 'normalize.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { notifyIsTotal } from './notification';\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  root: document.querySelector('.gallery'),\n  guard: document.querySelector('.guard'),\n};\n\nlet page = 1;\nlet searchQuery = '';\nlet totalLength = 0;\nlet modal;\n\nrefs.form.addEventListener('submit', async event => {\n  event.preventDefault();\n  observe.unobserve(refs.guard);\n\n  const formData = new FormData(refs.form);\n\n  const data = {};\n\n  formData.forEach((value, key) => {\n    data[key] = value;\n  });\n\n  refs.root.innerHTML = '';\n  searchQuery = data.searchQuery.trim();\n  page = 1;\n\n  if (!searchQuery) return;\n\n  const { hits, totalHits } = await fetchImages(searchQuery, page, true);\n\n  totalLength = hits.length;\n\n  refs.root.insertAdjacentHTML('beforeend', createCardTemplate(hits));\n\n  modal = new SimpleLightbox('.gallery a', {\n    overlay: true,\n    spinner: true,\n    overlayOpacity: 0.8,\n  });\n\n  if (totalHits === totalLength) {\n    observe.disconnect();\n    notifyIsTotal();\n  } else {\n    observe.observe(refs.guard);\n  }\n});\n\nconst options = {\n  root: null,\n  rootMargin: '100px',\n  threshold: 1.0,\n};\n\nconst observe = new IntersectionObserver(handleLoadMore, options);\n\nfunction handleLoadMore(entries) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      page += 1;\n\n      const { hits, totalHits } = await fetchImages(searchQuery, page);\n\n      totalLength += hits.length;\n\n      refs.root.insertAdjacentHTML('beforeend', createCardTemplate(hits));\n\n      modal.refresh();\n\n      if (totalHits === totalLength) {\n        observe.disconnect();\n        notifyIsTotal();\n      }\n    }\n  });\n}\n"],"names":["notifyError","iziToast","notifySuccess","value","notifyIsTotal","axios","API_KEY","fetchImages","page","isSubmit","params","data","createCardTemplate","images","webformatURL","largeImageURL","likes","views","comments","downloads","type","refs","searchQuery","totalLength","modal","event","observe","formData","key","hits","totalHits","SimpleLightbox","options","handleLoadMore","entries","entry"],"mappings":"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"}